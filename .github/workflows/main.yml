name: Main

on:
  workflow_dispatch:
  schedule:
  - cron: "0 2 * * *"

jobs:
  refresh_ubuntu:
    name: refresh ubuntu tags
    runs-on: ubuntu-latest
    steps:
    - name: 'Clone repository'
      run: |
        git clone --filter=blob:none --no-checkout https://github.com/sirdarckcat/ubuntu .
    - name: 'Re-configure remotes'
      run: |
        curl https://raw.githubusercontent.com/sirdarckcat/ubuntu/automation/git_config >> .git/config
        git remote | grep -v origin | xargs -i git fetch {} --tags --filter=blob:none --verbose --progress
        git push --tags
